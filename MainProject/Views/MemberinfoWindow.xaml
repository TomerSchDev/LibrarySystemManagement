<Window x:Class="Library_System_Management.Views.MemberInfoWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Member Information" Height="600" Width="800"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
            <RowDefinition />
            <RowDefinition />
        </Grid.RowDefinitions>

        <!-- Member Info -->
        <GroupBox Grid.Row="0" Header="Member Information" Padding="10" Margin="0,0,0,10">
            <StackPanel Orientation="Vertical">
                <TextBlock Text="{Binding SelectedMember.FullName}" FontSize="16" FontWeight="Bold"/>
                <TextBlock Text="{Binding SelectedMember.Email}" />
                <TextBlock Text="{Binding SelectedMember.Phone}" />
            </StackPanel>
        </GroupBox>
        <Button Grid.Row="1" Content="Export Member Info" Width="*" Height="20" Margin="5" Click="BtnExportMember_Click"/>

        <!-- Current Borrowed Books -->
        <GroupBox Grid.Row="2" Header="Current Borrowed Books" Padding="10" Margin="0,0,0,10">
            <DockPanel>
                <!-- Add Borrow Button -->
                <Button Content="Add Borrow" DockPanel.Dock="Top" 
                        Margin="0,0,0,5" HorizontalAlignment="Right" Width="100"
                        Command="{Binding AddBorrowCommand}" />

                <!-- Borrowed Books Table -->
                <DataGrid ItemsSource="{Binding CurrentBorrows}" AutoGenerateColumns="False"
                          CanUserAddRows="False" IsReadOnly="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Title" Binding="{Binding Book.Title}" Width="*"/>
                        <DataGridTextColumn Header="Author" Binding="{Binding Book.Author}" Width="*"/>
                        <DataGridTextColumn Header="Borrow Date" Binding="{Binding BorrowDate}" Width="150"/>
                        <DataGridTextColumn Header="Expected Return" Binding="{Binding ExpectedReturnDate}" Width="150"/>
                        <DataGridTemplateColumn Header="Actions" Width="150">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Button Content="Return" Margin="2"
                                                Command="{Binding DataContext.ReturnBookCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                CommandParameter="{Binding}"/>
                                        <Button Content="Extend" Margin="2"
                                                Command="{Binding DataContext.ExtendBorrowCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                CommandParameter="{Binding}"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>
        </GroupBox>
        <Button Grid.Row="3" Content="Export Borrow records" Width="*" Height="20" Margin="5" Click="BtnExportBorrow_Click"/>

        <!-- Borrow History -->
        <GroupBox Grid.Row="4" Header="Borrow History" Padding="10">
            <DataGrid ItemsSource="{Binding BorrowHistory}" AutoGenerateColumns="False"
                      CanUserAddRows="False" IsReadOnly="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Title" Binding="{Binding Book.Title}" Width="*"/>
                    <DataGridTextColumn Header="Author" Binding="{Binding Book.Author}" Width="*"/>
                    <DataGridTextColumn Header="Borrow Date" Binding="{Binding BorrowDate}" Width="150"/>
                    <DataGridTextColumn Header="Expected Return" Binding="{Binding ExpectedReturnDate}" Width="150"/>
                    <DataGridTextColumn Header="Returned On" Binding="{Binding ReturnDate}" Width="150"/>
                    <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="120"/>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>
    </Grid>
</Window>
